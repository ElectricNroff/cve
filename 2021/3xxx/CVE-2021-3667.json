{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "state": "PUBLISHED",
        "cveId": "CVE-2021-3667",
        "assignerOrgId": "53f830b8-0a3f-465b-8143-3b8a9948e749",
        "assignerShortName": "redhat",
        "dateUpdated": "2023-02-02T15:48:34.438Z",
        "dateReserved": "2021-07-27T00:00:00",
        "datePublished": "2022-03-02T00:00:00"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:advanced_virtualization:8.2::el8"
                    ],
                    "defaultStatus": "affected",
                    "packageName": "virt:8.2",
                    "product": "Advanced Virtualization for RHEL 8.2.1",
                    "vendor": "Red Hat",
                    "versions": [
                        {
                            "lessThan": "*",
                            "status": "unaffected",
                            "version": "8020120210917153657.863bb0db",
                            "versionType": "rpm"
                        }
                    ],
                    "x_redhatAdvisory": "RHSA-2021:3704"
                },
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:advanced_virtualization:8.2::el8"
                    ],
                    "defaultStatus": "affected",
                    "packageName": "virt-devel:8.2",
                    "product": "Advanced Virtualization for RHEL 8.2.1",
                    "vendor": "Red Hat",
                    "versions": [
                        {
                            "lessThan": "*",
                            "status": "unaffected",
                            "version": "8020120210917153657.863bb0db",
                            "versionType": "rpm"
                        }
                    ],
                    "x_redhatAdvisory": "RHSA-2021:3704"
                },
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:advanced_virtualization:8.4::el8"
                    ],
                    "defaultStatus": "affected",
                    "packageName": "virt:av",
                    "product": "Advanced Virtualization for RHEL 8.4.0.Z",
                    "vendor": "Red Hat",
                    "versions": [
                        {
                            "lessThan": "*",
                            "status": "unaffected",
                            "version": "8040020210922084349.522a0ee4",
                            "versionType": "rpm"
                        }
                    ],
                    "x_redhatAdvisory": "RHSA-2021:3703"
                },
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:advanced_virtualization:8.4::el8"
                    ],
                    "defaultStatus": "affected",
                    "packageName": "virt-devel:av",
                    "product": "Advanced Virtualization for RHEL 8.4.0.Z",
                    "vendor": "Red Hat",
                    "versions": [
                        {
                            "lessThan": "*",
                            "status": "unaffected",
                            "version": "8040020210922084349.522a0ee4",
                            "versionType": "rpm"
                        }
                    ],
                    "x_redhatAdvisory": "RHSA-2021:3703"
                },
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:enterprise_linux:8::crb",
                        "cpe:/a:redhat:enterprise_linux:8::appstream"
                    ],
                    "defaultStatus": "affected",
                    "packageName": "virt-devel:rhel",
                    "product": "Red Hat Enterprise Linux 8",
                    "vendor": "Red Hat",
                    "versions": [
                        {
                            "lessThan": "*",
                            "status": "unaffected",
                            "version": "8050020211001230723.b4937e53",
                            "versionType": "rpm"
                        }
                    ],
                    "x_redhatAdvisory": "RHSA-2021:4191"
                },
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:enterprise_linux:8::crb",
                        "cpe:/a:redhat:enterprise_linux:8::appstream"
                    ],
                    "defaultStatus": "affected",
                    "packageName": "virt:rhel",
                    "product": "Red Hat Enterprise Linux 8",
                    "vendor": "Red Hat",
                    "versions": [
                        {
                            "lessThan": "*",
                            "status": "unaffected",
                            "version": "8050020211001230723.b4937e53",
                            "versionType": "rpm"
                        }
                    ],
                    "x_redhatAdvisory": "RHSA-2021:4191"
                },
                {
                    "collection_url": "libvirt",
                    "cpes": [
                        "cpe:/o:redhat:enterprise_linux:6"
                    ],
                    "defaultStatus": "unaffected",
                    "product": "Red Hat Enterprise Linux 6",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Not affected"
                },
                {
                    "collection_url": "libvirt",
                    "cpes": [
                        "cpe:/o:redhat:enterprise_linux:7"
                    ],
                    "defaultStatus": "unknown",
                    "product": "Red Hat Enterprise Linux 7",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Out of support scope"
                },
                {
                    "collection_url": "virt:8.2/libvirt",
                    "cpes": [
                        "cpe:/a:redhat:advanced_virtualization:8::el8"
                    ],
                    "defaultStatus": "affected",
                    "product": "Red Hat Enterprise Linux 8 Advanced Virtualization",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Affected"
                },
                {
                    "collection_url": "virt:8.3/libvirt",
                    "cpes": [
                        "cpe:/a:redhat:advanced_virtualization:8::el8"
                    ],
                    "defaultStatus": "affected",
                    "product": "Red Hat Enterprise Linux 8 Advanced Virtualization",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Will not fix"
                },
                {
                    "collection_url": "virt:av/libvirt",
                    "cpes": [
                        "cpe:/a:redhat:advanced_virtualization:8::el8"
                    ],
                    "defaultStatus": "affected",
                    "product": "Red Hat Enterprise Linux 8 Advanced Virtualization",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Affected"
                },
                {
                    "collection_url": "libvirt",
                    "cpes": [
                        "cpe:/o:redhat:enterprise_linux:9"
                    ],
                    "defaultStatus": "unaffected",
                    "product": "Red Hat Enterprise Linux 9",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Not affected"
                },
                {
                    "collection_url": "https://packages.fedoraproject.org/",
                    "defaultStatus": "affected",
                    "packageName": "libvirt",
                    "product": "Fedora",
                    "vendor": "Fedora",
                    "x_redhatStatus": "Affected"
                }
            ],
            "datePublic": "2021-07-21T00:00:00Z",
            "descriptions": [
                {
                    "lang": "en",
                    "value": "An improper locking issue was found in the virStoragePoolLookupByTargetPath API of libvirt. It occurs in the storagePoolLookupByTargetPath function where a locked virStoragePoolObj object is not properly released on ACL permission failure. Clients connecting to the read-write socket with limited ACL permissions could use this flaw to acquire the lock and prevent other users from accessing storage pool/volume APIs, resulting in a denial of service condition. The highest threat from this vulnerability is to system availability."
                }
            ],
            "metrics": [
                {
                    "other": {
                        "content": {
                            "namespace": "https://access.redhat.com/security/updates/classification/",
                            "value": "Low"
                        },
                        "type": "Red Hat severity rating"
                    }
                },
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
                        "version": "3.1"
                    },
                    "format": "CVSS"
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-667",
                            "description": "Improper Locking",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "53f830b8-0a3f-465b-8143-3b8a9948e749",
                "shortName": "redhat",
                "dateUpdated": "2023-02-02T15:48:34.438Z"
            },
            "references": [
                {
                    "name": "RHSA-2021:3703",
                    "tags": [
                        "vendor-advisory",
                        "x_redhatRef"
                    ],
                    "url": "https://access.redhat.com/errata/RHSA-2021:3703"
                },
                {
                    "name": "RHSA-2021:3704",
                    "tags": [
                        "vendor-advisory",
                        "x_redhatRef"
                    ],
                    "url": "https://access.redhat.com/errata/RHSA-2021:3704"
                },
                {
                    "name": "RHSA-2021:4191",
                    "tags": [
                        "vendor-advisory",
                        "x_redhatRef"
                    ],
                    "url": "https://access.redhat.com/errata/RHSA-2021:4191"
                },
                {
                    "tags": [
                        "vdb-entry",
                        "x_redhatRef"
                    ],
                    "url": "https://access.redhat.com/security/cve/CVE-2021-3667"
                },
                {
                    "name": "RHBZ#1986094",
                    "tags": [
                        "issue-tracking",
                        "x_redhatRef"
                    ],
                    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1986094"
                },
                {
                    "url": "https://gitlab.com/libvirt/libvirt/-/commit/447f69dec47e1b0bd15ecd7cd49a9fd3b050fb87"
                },
                {
                    "url": "https://libvirt.org/git/?p=libvirt.git%3Ba=commit%3Bh=447f69dec47e1b0bd15ecd7cd49a9fd3b050fb87"
                },
                {
                    "name": "GLSA-202210-06",
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://security.gentoo.org/glsa/202210-06"
                },
                {
                    "url": "https://security.netapp.com/advisory/ntap-20220331-0005/"
                }
            ],
            "timeline": [
                {
                    "lang": "en",
                    "time": "2021-07-21T00:00:00Z",
                    "value": "Reported to Red Hat."
                },
                {
                    "lang": "en",
                    "time": "2021-07-21T00:00:00Z",
                    "value": "Made public."
                }
            ],
            "title": "CVE-2021-3667 libvirt: Improper locking on ACL failure in virStoragePoolLookupByTargetPath API",
            "workarounds": [
                {
                    "lang": "en",
                    "value": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability."
                }
            ],
            "x_redHatCweChain": "CWE-667: Improper Locking"
        }
    }
}
