{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-43633",
        "assignerOrgId": "c15abc07-96a9-4d11-a503-5d621bfe42ba",
        "state": "PUBLISHED",
        "assignerShortName": "ASRG",
        "dateReserved": "2023-09-20T14:34:14.874Z",
        "datePublished": "2023-09-21T13:08:58.659Z",
        "dateUpdated": "2023-09-28T05:33:11.251Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "packageName": "EVE OS",
                    "product": "EVE OS",
                    "programFiles": [
                        "https://github.com/lf-edge/eve/tree/master/pkg/pillar/evetpm/tpm.go",
                        "https://github.com/lf-edge/eve/tree/master/pkg/grub/rootfs.cfg"
                    ],
                    "repo": "https://github.com/lf-edge/eve",
                    "vendor": " LF-Edge, Zededa",
                    "versions": [
                        {
                            "lessThan": "8.6.0",
                            "status": "affected",
                            "version": "0",
                            "versionType": "release"
                        },
                        {
                            "lessThan": "9.5.0",
                            "status": "affected",
                            "version": "9.0.0",
                            "versionType": "release"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "user": "00000000-0000-4000-9000-000000000000",
                    "value": "Ilay Levi"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "\n\nOn boot, the Pillar eve container checks for the existence and content of\n\u201c/config/GlobalConfig/global.json\u201d.\n<br>If the file exists, it overrides the existing configuration on the device on boot.\n<br>This allows an attacker to change the system\u2019s configuration, which also includes some\ndebug functions.\n<br>This could be used to unlock the ssh with custom \u201cauthorized_keys\u201d via the\n\u201cdebug.enable.ssh\u201d key, similar to the \u201cauthorized_keys\u201d finding that was noted before.\n<br>Other usages include unlocking the usb to enable the keyboard via the \u201cdebug.enable.usb\u201d\nkey, allowing VNC access via the \u201capp.allow.vnc\u201d key, and more.\n<br>An attacker could easily enable these debug functionalities without triggering the \u201cmeasured\nboot\u201d mechanism implemented by EVE OS, and without marking the device as \u201cUUD\u201d\n(\u201cUnknown Update Detected\u201d).\nThis is because the \u201c/config\u201d partition is not protected by \u201cmeasured boot\u201d, it is mutable and it\nis not encrypted in any way.<br><br>\n\n\n\nAn attacker can gain full control over the device without changing the PCR values, thereby not\ntriggering the \u201cmeasured boot\u201d mechanism, and having full access to the vault.\n\n\n<br><br>Note:\n<br>This issue was partially fixed in these commits (after disclosure to Zededa), where the config\npartition measurement was added to PCR13:\n<br>\u2022 aa3501d6c57206ced222c33aea15a9169d629141\n<br>\u2022 5fef4d92e75838cc78010edaed5247dfbdae1889.\n<br>This issue was made viable in version 9.0.0 when the calculation was moved to PCR14 but it was not included in the measured boot."
                        }
                    ],
                    "value": "\nOn boot, the Pillar eve container checks for the existence and content of\n\u201c/config/GlobalConfig/global.json\u201d.\n\nIf the file exists, it overrides the existing configuration on the device on boot.\n\nThis allows an attacker to change the system\u2019s configuration, which also includes some\ndebug functions.\n\nThis could be used to unlock the ssh with custom \u201cauthorized_keys\u201d via the\n\u201cdebug.enable.ssh\u201d key, similar to the \u201cauthorized_keys\u201d finding that was noted before.\n\nOther usages include unlocking the usb to enable the keyboard via the \u201cdebug.enable.usb\u201d\nkey, allowing VNC access via the \u201capp.allow.vnc\u201d key, and more.\n\nAn attacker could easily enable these debug functionalities without triggering the \u201cmeasured\nboot\u201d mechanism implemented by EVE OS, and without marking the device as \u201cUUD\u201d\n(\u201cUnknown Update Detected\u201d).\nThis is because the \u201c/config\u201d partition is not protected by \u201cmeasured boot\u201d, it is mutable and it\nis not encrypted in any way.\n\n\n\n\n\nAn attacker can gain full control over the device without changing the PCR values, thereby not\ntriggering the \u201cmeasured boot\u201d mechanism, and having full access to the vault.\n\n\n\n\nNote:\n\nThis issue was partially fixed in these commits (after disclosure to Zededa), where the config\npartition measurement was added to PCR13:\n\n\u2022 aa3501d6c57206ced222c33aea15a9169d629141\n\n\u2022 5fef4d92e75838cc78010edaed5247dfbdae1889.\n\nThis issue was made viable in version 9.0.0 when the calculation was moved to PCR14 but it was not included in the measured boot."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-115",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-115 Authentication Bypass"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "HIGH",
                        "baseScore": 8.8,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "CHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-522",
                            "description": "CWE-522 Insufficiently Protected Credentials",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-922",
                            "description": "CWE-922 Insecure Storage of Sensitive Information",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "c15abc07-96a9-4d11-a503-5d621bfe42ba",
                "shortName": "ASRG",
                "dateUpdated": "2023-09-28T05:33:11.251Z"
            },
            "references": [
                {
                    "url": "https://asrg.io/security-advisories/cve-2023-43633/"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Debug Functions Unlockable Without Triggering Measured Boot",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}
