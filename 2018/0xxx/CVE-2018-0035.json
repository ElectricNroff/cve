{
    "containers": {
        "cna": {
            "affected": [
                {
                    "platforms": [
                        "QFX5200 and QFX10002"
                    ],
                    "product": "Junos OS",
                    "vendor": "Juniper Networks",
                    "versions": [
                        {
                            "lessThan": "15.1X53-D60",
                            "status": "affected",
                            "version": "15.1X53",
                            "versionType": "custom"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "value": "Customer can identify whether their device is affected by running the following commands from the Junos OS shell:\n\nAffected System :\n  root@:RE:0% rsh -l root -JU __juniper_private4__ 192.168.1.1                                                                                                                      \n  root@:RE:0~# grub-fstest /dev/sda2 ls /var/tmp /onie/ | grep onie                                                                                                                \n  vmlinuz-3.2.35-onie initrd.img-3.2.35-onie tools/ grub/ grub.d/                                                                                                                         \n  root@:RE:0:~#                                                                                                                                                                     \nNote: the two files, vmlinuz-3.2.35-onie and initrd.img-3.2.35-onie (version may vary) will be present.\n\nNon-affected System:\n  root@:RE:0% rsh -l root -JU __juniper_private4__ 192.168.1.1                                                                                                                                                                                                                                                                                                               \n  root@local-node:~# grub-fstest /dev/sda2 ls /onie/ | grep onie                                                                                                                          \n  root@local-node:~#                                                                                                                                                                      \nNote: no grep output related to ONIE partition."
                }
            ],
            "datePublic": "2018-07-11T00:00:00",
            "descriptions": [
                {
                    "lang": "en",
                    "value": "QFX5200 and QFX10002 devices that have been shipped with Junos OS 15.1X53-D21, 15.1X53-D30, 15.1X53-D31, 15.1X53-D32, 15.1X53-D33 and 15.1X53-D60 or have been upgraded to these releases using the .bin or .iso images are affected. This occurs because of an ONIE partition that should not have been present. A superuser can reboot to this partition, which has the effect of destroying the content/configuration of the Junos partition. Also, there is no root password for the system running from the Open Network Install Environment (ONIE) partition and thus access can be obtained at the console, or over the network (with a DCHP-assigned IP address and SSH). Note that upgrading to a later CLI release doesn't remove the ONIE partition."
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "metrics": [
                {
                    "cvssV3_0": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "HIGH",
                        "baseScore": 4.4,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "HIGH",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
                        "version": "3.0"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "description": "Denial of Service\n",
                            "lang": "en",
                            "type": "text"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "dateUpdated": "2018-07-27T09:57:01",
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper"
            },
            "references": [
                {
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://kb.juniper.net/JSA10869"
                },
                {
                    "name": "1041336",
                    "tags": [
                        "vdb-entry",
                        "x_refsource_SECTRACK"
                    ],
                    "url": "http://www.securitytracker.com/id/1041336"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "value": "In order to resolve this issue (remove the ONIE partition from the device), customer needs to reimage the device using the USB or PXE image from the Juniper download page.\nThe affected Junos image files have been removed from the Juniper download page."
                }
            ],
            "source": {
                "advisory": "JSA10869",
                "defect": [
                    "1335427",
                    "1335713"
                ],
                "discovery": "INTERNAL"
            },
            "title": "Junos OS: QFX5200 and QFX10002: Unintended ONIE partition was shipped with certain Junos OS .bin and .iso images",
            "workarounds": [
                {
                    "lang": "en",
                    "value": "There are no known workarounds for this issue.\nIt is good security practice to limit the exploitable attack surface of critical infrastructure networking equipment. Use access lists or firewall filters to limit access to device only from trusted, administrative networks or hosts. Limit CLI access to the device from only trusted hosts and administrators."
                }
            ]
        }
    },
    "cveMetadata": {
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "assignerShortName": "juniper",
        "cveId": "CVE-2018-0035",
        "dateReserved": "2017-11-16T00:00:00",
        "dateUpdated": "2018-07-27T09:57:01",
        "state": "PUBLISHED",
        "datePublished": "2018-07-11T18:00:00Z"
    },
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0"
}
