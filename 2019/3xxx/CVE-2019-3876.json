{
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:openshift:3.11::el7"
                    ],
                    "defaultStatus": "affected",
                    "packageName": "atomic-openshift",
                    "product": "Red Hat OpenShift Container Platform 3.11",
                    "vendor": "Red Hat",
                    "versions": [
                        {
                            "lessThan": "*",
                            "status": "unaffected",
                            "version": "0:3.11.129-1.git.0.bd4f2d5.el7",
                            "versionType": "rpm"
                        }
                    ],
                    "x_redhatAdvisory": "RHSA-2019:1851"
                },
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:openshift:3.11::el7"
                    ],
                    "defaultStatus": "affected",
                    "packageName": "jenkins-2-plugins",
                    "product": "Red Hat OpenShift Container Platform 3.11",
                    "vendor": "Red Hat",
                    "versions": [
                        {
                            "lessThan": "*",
                            "status": "unaffected",
                            "version": "0:3.11.1560870549-1.el7",
                            "versionType": "rpm"
                        }
                    ],
                    "x_redhatAdvisory": "RHSA-2019:1851"
                },
                {
                    "collection_url": "atomic-openshift",
                    "cpes": [
                        "cpe:/a:redhat:openshift:3.10"
                    ],
                    "defaultStatus": "affected",
                    "product": "Red Hat OpenShift Container Platform 3.10",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Fix deferred"
                },
                {
                    "collection_url": "atomic-openshift",
                    "cpes": [
                        "cpe:/a:redhat:openshift:3.4"
                    ],
                    "defaultStatus": "unknown",
                    "product": "Red Hat OpenShift Container Platform 3.4",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Out of support scope"
                },
                {
                    "collection_url": "atomic-openshift",
                    "cpes": [
                        "cpe:/a:redhat:openshift:3.5"
                    ],
                    "defaultStatus": "unknown",
                    "product": "Red Hat OpenShift Container Platform 3.5",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Out of support scope"
                },
                {
                    "collection_url": "atomic-openshift",
                    "cpes": [
                        "cpe:/a:redhat:openshift:3.6"
                    ],
                    "defaultStatus": "unknown",
                    "product": "Red Hat OpenShift Container Platform 3.6",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Out of support scope"
                },
                {
                    "collection_url": "atomic-openshift",
                    "cpes": [
                        "cpe:/a:redhat:openshift:3.7"
                    ],
                    "defaultStatus": "unknown",
                    "product": "Red Hat OpenShift Container Platform 3.7",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Out of support scope"
                },
                {
                    "collection_url": "atomic-openshift",
                    "cpes": [
                        "cpe:/a:redhat:openshift:3.9"
                    ],
                    "defaultStatus": "affected",
                    "product": "Red Hat OpenShift Container Platform 3.9",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Fix deferred"
                },
                {
                    "collection_url": "openshift",
                    "cpes": [
                        "cpe:/a:redhat:openshift:4"
                    ],
                    "defaultStatus": "unaffected",
                    "product": "Red Hat OpenShift Container Platform 4",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Not affected"
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "value": "This issue was discovered by Mo Khan (Red Hat)."
                }
            ],
            "datePublic": "2019-03-27T00:24:00Z",
            "descriptions": [
                {
                    "lang": "en",
                    "value": "A flaw was found in the /oauth/token/request custom endpoint of the OpenShift OAuth server allowing for XSS generation of CLI tokens due to missing X-Frame-Options and CSRF protections. If not otherwise prevented, a separate XSS vulnerability via JavaScript could further allow for the extraction of these tokens."
                }
            ],
            "metrics": [
                {
                    "other": {
                        "content": {
                            "namespace": "https://access.redhat.com/security/updates/classification/",
                            "value": "Moderate"
                        },
                        "type": "Red Hat severity rating"
                    }
                },
                {
                    "cvssV3_0": {
                        "attackComplexity": "HIGH",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "LOW",
                        "baseScore": 5,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "LOW",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
                        "version": "3.0"
                    },
                    "format": "CVSS"
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-352",
                            "description": "Cross-Site Request Forgery (CSRF)",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "53f830b8-0a3f-465b-8143-3b8a9948e749",
                "shortName": "redhat",
                "dateUpdated": "2023-02-02T13:59:40.644Z"
            },
            "references": [
                {
                    "name": "107664",
                    "tags": [
                        "vdb-entry",
                        "x_refsource_BID"
                    ],
                    "url": "http://www.securityfocus.com/bid/107664"
                },
                {
                    "name": "RHSA-2019:1851",
                    "tags": [
                        "vendor-advisory",
                        "x_redhatRef"
                    ],
                    "url": "https://access.redhat.com/errata/RHSA-2019:1851"
                },
                {
                    "tags": [
                        "vdb-entry",
                        "x_redhatRef"
                    ],
                    "url": "https://access.redhat.com/security/cve/CVE-2019-3876"
                },
                {
                    "name": "RHBZ#1691107",
                    "tags": [
                        "issue-tracking",
                        "x_redhatRef"
                    ],
                    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1691107"
                },
                {
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3876"
                }
            ],
            "timeline": [
                {
                    "lang": "en",
                    "time": "2019-03-13T00:00:00Z",
                    "value": "Reported to Red Hat."
                },
                {
                    "lang": "en",
                    "time": "2019-03-27T00:24:00Z",
                    "value": "Made public."
                }
            ],
            "title": "CVE-2019-3876 web-console: XSS in OAuth server /oauth/token/request endpoint",
            "workarounds": [
                {
                    "lang": "en",
                    "value": "Since at least v3.4, the OpenShift documentation [1] has specified the format for  corsAllowedOrigins to accurately match intended hostnames.  Since at least v3.7, installs will default to use the correct regular expression formatted variables.  Earlier versions may be configured with plain strings, a configuration which will persist across cluster upgrades, opening them to cross origin vulnerabilities such as this.\n\n\nAt a minimum, you should ensure that the corsAllowedOrigin definition within master-config.yaml contains elements in the form \n\n~~~\ncorsAllowedOrigins:\n- (?i)//my\\.subdomain\\.domain\\.com(:|\\z)\n~~~\n\nand not the form\n\n~~~\ncorsAllowedOrigins:\n- domain.com\n~~~\n\nas the first will permit cross origin requests only if the host matches exactly, whereas the second will permit from any host that merely contains the string (such as ABCDdomain.com or even domain.comABCD.com).\n\n\n\nFootnotes:\n\n[1] https://docs.openshift.com/container-platform/3.4/architecture/infrastructure_components/web_console.html#corsAllowedOrigins"
                }
            ],
            "x_redHatCweChain": "CWE-352: Cross-Site Request Forgery (CSRF)"
        }
    },
    "cveMetadata": {
        "assignerOrgId": "53f830b8-0a3f-465b-8143-3b8a9948e749",
        "assignerShortName": "redhat",
        "cveId": "CVE-2019-3876",
        "datePublished": "2019-04-01T14:15:42",
        "dateReserved": "2019-01-03T00:00:00",
        "dateUpdated": "2023-02-02T13:59:40.644Z",
        "state": "PUBLISHED"
    },
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0"
}
