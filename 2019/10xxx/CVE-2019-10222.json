{
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:ceph_storage:3::el7"
                    ],
                    "defaultStatus": "affected",
                    "packageName": "ceph",
                    "product": "Red Hat Ceph Storage 3.3",
                    "vendor": "Red Hat",
                    "versions": [
                        {
                            "lessThan": "*",
                            "status": "unaffected",
                            "version": "2:12.2.12-48.el7cp",
                            "versionType": "rpm"
                        }
                    ],
                    "x_redhatAdvisory": "RHSA-2019:2577"
                },
                {
                    "collectionUrl": "https://access.redhat.com/downloads/content/package-browser/",
                    "cpe": [
                        "cpe:/a:redhat:ceph_storage:3::ubuntu16.04"
                    ],
                    "defaultStatus": "unaffected",
                    "packageName": "ceph",
                    "product": "Red Hat Ceph Storage 3 for Ubuntu",
                    "vendor": "Red Hat",
                    "x_redhatAdvisory": "RHSA-2019:2579"
                },
                {
                    "collection_url": "ceph",
                    "cpes": [
                        "cpe:/a:redhat:ceph_storage:2"
                    ],
                    "defaultStatus": "unaffected",
                    "product": "Red Hat Ceph Storage 2",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Not affected"
                },
                {
                    "collection_url": "ceph-common",
                    "cpes": [
                        "cpe:/o:redhat:enterprise_linux:7"
                    ],
                    "defaultStatus": "unaffected",
                    "product": "Red Hat Enterprise Linux 7",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Not affected"
                },
                {
                    "collection_url": "ceph",
                    "cpes": [
                        "cpe:/o:redhat:enterprise_linux:8"
                    ],
                    "defaultStatus": "unaffected",
                    "product": "Red Hat Enterprise Linux 8",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Not affected"
                },
                {
                    "collection_url": "ceph",
                    "cpes": [
                        "cpe:/a:redhat:openstack:13"
                    ],
                    "defaultStatus": "unaffected",
                    "product": "Red Hat OpenStack Platform 13 (Queens)",
                    "vendor": "Red Hat",
                    "x_redhatStatus": "Not affected"
                },
                {
                    "collection_url": "https://packages.fedoraproject.org/",
                    "defaultStatus": "affected",
                    "packageName": "ceph",
                    "product": "Fedora",
                    "vendor": "Fedora",
                    "x_redhatStatus": "Affected"
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "value": "Red Hat would like to thank Abhishek Lekshmanan (SUSE Software Solutions Germany) for reporting this issue."
                }
            ],
            "datePublic": "2019-08-28T14:00:00Z",
            "descriptions": [
                {
                    "lang": "en",
                    "value": "A flaw was found in the Ceph RGW configuration with Beast as the front end handling client requests. An unauthenticated attacker could crash the Ceph RGW server by sending valid HTTP headers and terminating the connection, resulting in a remote denial of service for Ceph RGW clients."
                }
            ],
            "metrics": [
                {
                    "other": {
                        "content": {
                            "namespace": "https://access.redhat.com/security/updates/classification/",
                            "value": "Important"
                        },
                        "type": "Red Hat severity rating"
                    }
                },
                {
                    "cvssV3_0": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.5,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                        "version": "3.0"
                    },
                    "format": "CVSS"
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-755",
                            "description": "Improper Handling of Exceptional Conditions",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "53f830b8-0a3f-465b-8143-3b8a9948e749",
                "shortName": "redhat",
                "dateUpdated": "2023-02-02T15:32:05.549Z"
            },
            "references": [
                {
                    "name": "RHSA-2019:2577",
                    "tags": [
                        "vendor-advisory",
                        "x_redhatRef"
                    ],
                    "url": "https://access.redhat.com/errata/RHSA-2019:2577"
                },
                {
                    "name": "RHSA-2019:2579",
                    "tags": [
                        "vendor-advisory",
                        "x_redhatRef"
                    ],
                    "url": "https://access.redhat.com/errata/RHSA-2019:2579"
                },
                {
                    "tags": [
                        "vdb-entry",
                        "x_redhatRef"
                    ],
                    "url": "https://access.redhat.com/security/cve/CVE-2019-10222"
                },
                {
                    "name": "RHBZ#1739292",
                    "tags": [
                        "issue-tracking",
                        "x_redhatRef"
                    ],
                    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1739292"
                },
                {
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10222"
                },
                {
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://tracker.ceph.com/issues/40018"
                }
            ],
            "timeline": [
                {
                    "lang": "en",
                    "time": "2019-08-08T00:00:00Z",
                    "value": "Reported to Red Hat."
                },
                {
                    "lang": "en",
                    "time": "2019-08-28T14:00:00Z",
                    "value": "Made public."
                }
            ],
            "title": "CVE-2019-10222 ceph: Unauthenticated clients can crash ceph RGW configured with beast as frontend",
            "workarounds": [
                {
                    "lang": "en",
                    "value": "To mitigate this issue either of the following options can be applied to system:\n\nMitigation 1:\n1. By default system will use /etc/init.d/ceph-radosgw\n   stop this service by\n\n~]# /etc/init.d/ceph-radosgw stop\n\n2. Create systemd service, and change command line parameters according to the environment\nwhere Ceph radosgw is running.\n\n~]# cat /usr/lib/systemd/system/ceph-rgw.service \n[Unit]\nDescription=Ceph RGW daemon\n\n[Service]\nType=forking\nExecStart=/bin/radosgw -n client.rgw.$(HOSTNAME REDACTED)\nRestart=on-abnormal\nRestartSec=1s\n\n[Install]\nWantedBy=multi-user.target\n\n3. Run systemd service 'ceph-rgw.service'\n\nCaveat: It still takes +1-2 sec to get service back online. After applying above mentioned mitigation, the malicious IP can be blocked by a firewall rule if there are continuous attempts to launch remote denial of service. This mitigation is of limited use if the attack is launched from multiple IPs. It is recommended to limit the exposure of ceph RGW server to known clients.\n\nOR \n\nMitigation 2:\nuse 'civetweb' as HTTP frontend with ceph RGW."
                }
            ],
            "x_redHatCweChain": "CWE-755: Improper Handling of Exceptional Conditions"
        }
    },
    "cveMetadata": {
        "assignerOrgId": "53f830b8-0a3f-465b-8143-3b8a9948e749",
        "assignerShortName": "redhat",
        "cveId": "CVE-2019-10222",
        "datePublished": "2019-11-08T14:45:41",
        "dateReserved": "2019-03-27T00:00:00",
        "dateUpdated": "2023-02-02T15:32:05.549Z",
        "state": "PUBLISHED"
    },
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0"
}
